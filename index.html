<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIP 專屬抽獎池 - PRESTIGE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&family=Noto+Sans+TC:wght@300;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --obsidian: #0a0a0a;
            --gold-matte: #c5a059;
            --gold-light: #f3e5ab;
            --gold-dark: #8c6d31;
            --accent-red: #ff2d55;
            --accent-blue: #007aff;
        }

        body {
            background-color: #050505;
            background-image: radial-gradient(circle at 50% 0%, #1a1a1a 0%, #050505 100%);
            color: #fff;
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            min-height: 100vh;
            display: flex; justify-content: center; align-items: center; padding: 20px;
            margin: 0;
        }

        /* --- 2025 高階黑膠標題 --- */
        .title-prestige {
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            background: linear-gradient(to bottom, var(--gold-light) 0%, var(--gold-matte) 50%, var(--gold-dark) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            line-height: 1.2;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5));
        }

        /* 語系下拉選單 */
        .lang-control { position: fixed; top: 1.5rem; right: 1.5rem; z-index: 9999; }
        .lang-select {
            background: rgba(0, 0, 0, 0.8); border: 1px solid rgba(197, 160, 89, 0.3); color: var(--gold-matte);
            padding: 8px 32px 8px 12px; border-radius: 6px; font-size: 11px; font-weight: bold;
            appearance: none; cursor: pointer; outline: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23c5a059' stroke-width='3' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat; background-position: right 10px center;
            backdrop-filter: blur(10px);
        }

        .glass-card {
            background: var(--obsidian);
            border: 1px solid rgba(197, 160, 89, 0.15);
            border-radius: 48px; width: 100%; max-width: 650px; padding: 50px;
            box-shadow: 0 40px 120px rgba(0,0,0,1); position: relative;
        }

        /* --- 皇冠：定位在 Bar 上方 --- */
        .crown-on-bar {
            position: absolute;
            top: -42px; /* 剛好懸浮在 Bar 上方 */
            width: 45px; height: 45px;
            filter: drop-shadow(0 0 12px var(--gold-matte));
            z-index: 50; display: none;
            transition: all 0.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            animation: crownFloat 3s infinite ease-in-out;
        }
        @keyframes crownFloat { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-8px); } }

        /* 進度條容器 */
        .progress-wrapper { position: relative; margin-bottom: 40px; margin-top: 20px; }
        .progress-container { height: 60px; background: #000; border-radius: 16px; position: relative; overflow: hidden; border: 1px solid rgba(255, 255, 255, 0.05); display: flex; }
        
        .bar-a { background: linear-gradient(90deg, #600, var(--accent-red)); transition: width 1.2s ease; display: flex; align-items: center; justify-content: center; }
        .bar-b { background: linear-gradient(90deg, var(--accent-blue), #003); transition: width 1.2s ease; display: flex; align-items: center; justify-content: center; }
        .percent-text { font-weight: 900; font-size: 1.4rem; color: #fff; }
        .vs-label { position: absolute; left: 50%; top: 50%; transform: translate(-50%, -50%); background: #fff; color: #000; font-weight: 900; padding: 2px 10px; border-radius: 4px; font-size: 11px; z-index: 10; }

        /* 規則框 */
        .rule-box-matte {
            background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.05);
            padding: 24px; border-radius: 20px;
        }

        /* 按鈕樣式：電鍍感 */
        .btn-obsidian { border-radius: 16px; font-weight: 900; font-size: 12px; letter-spacing: 2px; text-transform: uppercase; transition: 0.3s; cursor: pointer; border: 1px solid rgba(255,255,255,0.1); }
        .btn-a-red { background: linear-gradient(145deg, #300, #100); color: #ff2d55; }
        .btn-a-red:hover { background: #600; color: #fff; border-color: #ff2d55; }
        .btn-b-blue { background: linear-gradient(145deg, #003, #001); color: #007aff; }
        .btn-b-blue:hover { background: #0056b3; color: #fff; border-color: #007aff; }

        /* 自定義確認框 (Modal) */
        #voteModal {
            display: none; position: fixed; inset: 0; z-index: 10000;
            background: rgba(0, 0, 0, 0.9); backdrop-filter: blur(15px);
            align-items: center; justify-content: center; padding: 20px;
        }
        .modal-content {
            background: #0f0f0f; border: 1px solid var(--gold-matte); border-radius: 32px;
            padding: 40px; max-width: 400px; width: 100%; text-align: center;
        }
        .modal-btn-yes { background: var(--gold-matte); color: #000; font-weight: 900; padding: 12px 32px; border-radius: 12px; transition: 0.3s; }
        .modal-btn-no { color: #666; font-weight: bold; padding: 12px 32px; margin-right: 12px; transition: 0.3s; }
        .modal-btn-no:hover { color: #fff; }

        /* 限定成就區 */
        .ultimate-card { position: relative; background: rgba(197, 160, 89, 0.05); border-radius: 32px; padding: 3px; overflow: hidden; margin-top: 50px; }
        .ultimate-card::before { content: ""; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background: conic-gradient(transparent, transparent, var(--gold-matte)); animation: rotate 5s linear infinite; }
        .ultimate-inner { position: relative; z-index: 1; background: #080808; border-radius: 30px; padding: 25px; display: flex; align-items: center; gap: 25px; }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div class="lang-control">
        <select class="lang-select" onchange="changeLang(this.value)" id="langDropdown">
            <option value="zh-TW">繁體中文</option>
            <option value="zh-CN">简体中文</option>
            <option value="en">English</option>
            <option value="ja">日本語</option>
        </select>
    </div>

    <div id="voteModal">
        <div class="modal-content">
            <h2 id="i18n-modal-title" class="text-xl font-black text-[#f3e5ab] mb-4">確認投票嗎？</h2>
            <p id="i18n-modal-msg" class="text-xs text-gray-400 mb-8 leading-relaxed">投票後不得更改選項，確認投票嗎？</p>
            <div class="flex justify-center">
                <button onclick="closeModal()" id="i18n-modal-no" class="modal-btn-no">否</button>
                <button onclick="confirmVote()" id="i18n-modal-yes" class="modal-btn-yes">是</button>
            </div>
        </div>
    </div>

    <div class="glass-card">
        <header class="text-center mb-10">
            <h1 id="i18n-main-title" class="title-prestige text-4xl md:text-5xl mb-10">VIP 專屬抽獎池</h1>
            <div class="rule-box-matte text-left">
                <h3 id="i18n-rule-header" class="text-[10px] font-bold text-[#c5a059] tracking-[0.3em] uppercase mb-3">Activity Rules / 活動規則</h3>
                <ul id="i18n-rules-list" class="text-[11px] text-gray-500 space-y-2 font-light leading-relaxed"></ul>
            </div>
        </header>

        <!-- 【上層】數據 Bar 與人數 (皇冠在此定位) -->
        <div class="progress-wrapper">
            <svg id="crown" class="crown-on-bar" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M5 21H19V19H5V21ZM5 17H19V11L15 13L12 7L9 13L5 11V17ZM12 5C13.1046 5 14 4.10457 14 3C14 1.89543 13.1046 1 12 1C10.8954 1 10 1.89543 10 3C10 4.10457 10.8954 5 12 5Z" fill="#c5a059"/>
            </svg>
            <div class="progress-container mb-3">
                <div id="bar-a" class="bar-a" style="width: 50%"><span id="percent-a" class="percent-text">50%</span></div>
                <div id="bar-b" class="bar-b" style="width: 50%"><span id="percent-b" class="percent-text">50%</span></div>
                <div class="vs-label">VS</div>
            </div>
            <div class="flex justify-between px-3 text-[10px] font-black text-gray-600 tracking-[0.2em] uppercase">
                <span id="count-a">0 人已投票</span>
                <span id="count-b">0 人已投票</span>
            </div>
        </div>

        <!-- 【中層】獎項圖片 -->
        <div class="grid grid-cols-2 gap-8 mb-12">
            <div class="text-center">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/5/5e/Nintendo_Switch_Console.png/640px-Nintendo_Switch_Console.png" class="h-24 mx-auto mb-4 object-contain filter drop-shadow-2xl" alt="Switch">
                <p class="text-[9px] text-gray-600 font-bold tracking-widest uppercase">Team Switch</p>
            </div>
            <div class="text-center">
                <img src="https://www.freeiconspng.com/uploads/diamond-png-21.png" class="h-24 mx-auto mb-4 object-contain filter drop-shadow-2xl" alt="Diamond">
                <p class="text-[9px] text-gray-600 font-bold tracking-widest uppercase">Team Diamond</p>
            </div>
        </div>

        <!-- 【下層】選擇按鈕 -->
        <div class="grid grid-cols-2 gap-4">
            <button id="i18n-btn-a" onclick="openVoteModal('A')" class="btn-obsidian btn-a-red py-4">選擇 Switch</button>
            <button id="i18n-btn-b" onclick="openVoteModal('B')" class="btn-obsidian btn-b-blue py-4">選擇 鑽石</button>
        </div>

        <!-- 加碼區 -->
        <div class="ultimate-card">
            <div class="ultimate-inner">
                <div class="flex-shrink-0 relative">
                    <img src="https://img.icons8.com/fluency/240/iphone-14-pro.png" class="w-16 relative" alt="iPhone">
                </div>
                <div>
                    <div class="inline-block px-2 py-1 bg-yellow-500/10 rounded border border-yellow-500/20 mb-2">
                        <span id="i18n-tag" class="text-[9px] text-yellow-600 font-black tracking-widest uppercase">限定成就加碼</span>
                    </div>
                    <h4 id="i18n-grand-title" class="metallic-text text-lg mb-1 leading-tight">50% vs 50% 則抽出 iPhone 17 Pro</h4>
                    <p id="i18n-grand-desc" class="text-[10px] text-gray-600 font-light"></p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const MOCK_BASE = { A: 2542, B: 2498 };
        let selectedChoice = null;

        const i18n = {
            'zh-TW': {
                mainTitle: 'VIP 專屬抽獎池', btnA: 'Switch', btnB: '鑽石',
                modalTitle: '確認投票嗎？', modalMsg: '投票後不得更改選項，確認投票嗎？',
                modalYes: '是', modalNo: '否', votedSuffix: '人已投票', tag: '限定成就加碼',
                rules: [
                    '1. 選擇參與獎池，若選擇的獎項為多數則抽取投票該獎項用戶',
                    '2. 活動期間不可任意更改選擇',
                    '3. 結束後統計最終比例',
                    '4. 投票比例不相同，則僅抽出比例最高獎池之投票名單',
                    '5. 若最終比例為50% vs 50% 則從全體用戶抽出 iPhone 17 Pro，原獎項不抽'
                ],
                grandTitle: '50% vs 50% 則抽出 iPhone 17 Pro',
                grandDesc: '若最終比例為完美平衡，將從全體用戶抽出 iPhone 17 Pro，原獎項不抽。'
            },
            'en': {
                mainTitle: 'VIP PRESTIGE POOL', btnA: 'Switch', btnB: 'Diamond',
                modalTitle: 'Confirm Vote?', modalMsg: 'Once voted, your choice is final. Confirm?',
                modalYes: 'YES', modalNo: 'NO', votedSuffix: 'Voted', tag: 'PRESTIGE REWARD',
                rules: [
                    '1. Select a pool; majority winners enter the draw.',
                    '2. Selection is final.',
                    '3. Ratios counted after the event.',
                    '4. Only the majority side enters the draw.',
                    '5. If 50/50, iPhone 17 Pro will be drawn from ALL users.'
                ],
                grandTitle: '50/50 Unlocks iPhone 17 Pro',
                grandDesc: 'If final ratios are balanced, iPhone 17 Pro will be drawn for all users.'
            }
            // ... 簡中、日文可依此類推
        };

        function changeLang(lang) {
            const d = i18n[lang] || i18n['en'];
            document.getElementById('i18n-main-title').innerText = d.mainTitle;
            document.getElementById('i18n-btn-a').innerText = '選擇 ' + d.btnA;
            document.getElementById('i18n-btn-b').innerText = '選擇 ' + d.btnB;
            document.getElementById('i18n-modal-title').innerText = d.modalTitle;
            document.getElementById('i18n-modal-msg').innerText = d.modalMsg;
            document.getElementById('i18n-modal-yes').innerText = d.modalYes;
            document.getElementById('i18n-modal-no').innerText = d.modalNo;
            document.getElementById('i18n-tag').innerText = d.tag;
            document.getElementById('i18n-grand-title').innerText = d.grandTitle;
            document.getElementById('i18n-grand-desc').innerText = d.grandDesc;
            const list = document.getElementById('i18n-rules-list');
            list.innerHTML = d.rules.map(r => `<li>${r}</li>`).join('');
            updateUI(lang);
        }

        function updateUI(lang = document.getElementById('langDropdown').value) {
            const userVote = localStorage.getItem('voted_vip_final_local');
            let countA = MOCK_BASE.A + (userVote === 'A' ? 1 : 0);
            let countB = MOCK_BASE.B + (userVote === 'B' ? 1 : 0);
            let total = countA + countB;
            let pA = Math.round((countA / total) * 1000) / 10;
            let pB = Math.round((100 - pA) * 10) / 10;

            document.getElementById('bar-a').style.width = pA + '%';
            document.getElementById('bar-b').style.width = pB + '%';
            document.getElementById('percent-a').innerText = pA + '%';
            document.getElementById('percent-b').innerText = pB + '%';
            
            const suffix = (i18n[lang] || i18n['en']).votedSuffix;
            document.getElementById('count-a').innerText = `${countA.toLocaleString()} ${suffix}`;
            document.getElementById('count-b').innerText = `${countB.toLocaleString()} ${suffix}`;

            // --- 皇冠位置邏輯 (在 Bar 上方) ---
            const crown = document.getElementById('crown');
            if (countA === countB) { crown.style.display = 'none'; }
            else {
                crown.style.display = 'block';
                if (countA > countB) {
                    crown.style.left = '0%'; crown.style.right = 'auto'; crown.style.transform = 'translateX(0)';
                } else {
                    crown.style.left = 'auto'; crown.style.right = '0%'; crown.style.transform = 'translateX(0)';
                }
            }
        }

        function openVoteModal(choice) {
            if (localStorage.getItem('voted_vip_final_local')) {
                alert('您已經投票過囉！');
                return;
            }
            selectedChoice = choice;
            document.getElementById('voteModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('voteModal').style.display = 'none';
        }

        function confirmVote() {
            localStorage.setItem('voted_vip_final_local', selectedChoice);
            closeModal();
            updateUI();
            alert('投票成功！');
        }

        const navLang = navigator.language.includes('zh') ? 'zh-TW' : 'en';
        document.getElementById('langDropdown').value = navLang;
        changeLang(navLang);
    </script>
</body>
</html>
